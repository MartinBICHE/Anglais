<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Profile - Statistics</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
</head>
<body>
    <a href="/" class="back-button">← Back to Menu</a>

    <div class="container">
        <h1>Statistics for {{ username }}</h1>
        
        <div class="tabs">
            <button class="tab-button" data-game="crossword">Crossword</button>
            <button class="tab-button" data-game="word_search_puzzle">Word Search</button>
            <button class="tab-button" data-game="memory">Memory</button>
            <button class="tab-button active" data-game="fill_the_blanks">Fill the blanks</button>
        </div>

        <!-- Fill the blanks -->
        <div class="tab-content hidden" id="fill_the_blanks">
            <h2>Fill the blanks</h2>
            <p>Games played: {{ ftb_stats.global.games_played }}</p>
            <p>Score: min {{ ftb_stats.global.min_score or "—" }}, max {{ ftb_stats.global.max_score or "—" }}, average {{ "%.2f"|format(ftb_stats.global.avg_score) if ftb_stats.global.avg_score else "—" }}</p>

            <h3>By theme</h3>
            {% for theme in ftb_stats.by_theme %}
                <p><strong>{{ theme.theme }}</strong> — 
                {{ theme.games_played }} games, 
                score: min {{ theme.min_score or "—" }}, 
                max {{ theme.max_score or "—" }}, 
                avg {{ "%.2f"|format(theme.avg_score) if theme.avg_score else "—" }}
                </p>
            {% endfor %}
        </div>

        <!-- Crossword -->
        <div class="tab-content hidden" id="crossword">
            <h2>Crossword</h2>
            <p>Games won: {{ stats.global[1] }} / {{ stats.global[0] }}</p>
            <p>Attempts: min {{ stats.global[2] }}, max {{ stats.global[3] }}, average {{ stats.global[4] }}</p>

            <h3>By theme</h3>
            {% for theme in stats.by_theme %}
                <p><strong>{{ theme[0] }}</strong> — {{ theme[2] }} / {{ theme[1] }} wins, {{ theme[3] }} attempts on average</p>
            {% endfor %}
        </div>

        <!-- Word Search -->
        <div class="tab-content hidden" id="word_search_puzzle">
            <h2>Word Search</h2>
            <p>Grids solved: {{ wsp_stats.global[1] }} / {{ wsp_stats.global[0] }}</p>
            <p>Time: min {{ wsp_stats.global[2]|int // 60 }}min {{ wsp_stats.global[2]|int % 60 }}s, 
                max {{ wsp_stats.global[3]|int // 60 }}min {{ wsp_stats.global[3]|int % 60 }}s, 
                average {{ wsp_stats.global[4]|int // 60 }}min {{ wsp_stats.global[4]|int % 60 }}s</p>
        
            <h3>By theme</h3>
            {% for theme_stat in wsp_stats.by_theme %}
                <p>
                    <strong>{{ theme_stat[0] }}</strong> — 
                    {{ theme_stat[2] }} / {{ theme_stat[1] }} wins, 
                    min {{ theme_stat[3]|int // 60 }}min {{ theme_stat[3]|int % 60 }}s, 
                    max {{ theme_stat[4]|int // 60 }}min {{ theme_stat[4]|int % 60 }}s, 
                    avg {{ theme_stat[5]|int // 60 }}min {{ theme_stat[5]|int % 60 }}s
                </p>
            {% endfor %}
        </div>
        
        <!-- Memory -->
        <div class="tab-content hidden" id="memory">
            <h2>Memory</h2>
            <p>Games won: {{ memory_stats.global[1] }} / {{ memory_stats.global[0] }}</p>
            <p>Attempts: 
                min {{ memory_stats.global[2] if memory_stats.global[2] is not none else "—" }}, 
                max {{ memory_stats.global[3] if memory_stats.global[3] is not none else "—" }}, 
                average {{ "%.2f"|format(memory_stats.global[5]) if memory_stats.global[5] is not none else "—" }}
            </p>
            
            <h3>By theme</h3>
            {% for theme in memory_stats.by_theme %}
                <p>
                    <strong>{{ theme[0] }}</strong> — 
                    {{ theme[2] }} / {{ theme[1] }} wins, 
                    attempts: 
                    min {{ theme[3] if theme[3] is not none else "—" }}, 
                    max {{ theme[4] if theme[4] is not none else "—" }}, 
                    avg {{ "%.2f"|format(theme[6]) if theme[6] is not none else "—" }}
                </p>
            {% endfor %}
        </div>
    </div>

    <script>
        const tabs = document.querySelectorAll('.tab-button');
        const contents = document.querySelectorAll('.tab-content');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                const selectedGame = tab.getAttribute('data-game');
                contents.forEach(content => {
                    if (content.id === selectedGame) {
                        content.classList.remove('hidden');
                    } else {
                        content.classList.add('hidden');
                    }
                });
            });
        });
    </script>
</body>
</html>
